 <!DOCTYPE html>
 <html>
   <link rel="stylesheet" href="./FBA/mobile_green.css"/>
 <head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width">
   <title>Mobile Balance - LOGIN</title>

  
</head>

<SCRIPT type="text/javascript" src="/client.js"></SCRIPT>


<body onLoad="setParams();">

<SCRIPT>

   function setParams() {
      const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);

      let sidControl = document.getElementById("sessionId");
      if(sidControl) sidControl.value=urlParams.get('sessionId');
      else console.log("no sessionId Control");


      let clientControl = document.getElementById("client");
      if(clientControl) clientControl.value=urlParams.get('client');
      else console.log("no client Control");

      let yearControl = document.getElementById("year");
      if(yearControl) yearControl.value=urlParams.get('year');
      else console.log("no year Control");
   }


   var reader;
   var content;

   var readFile = function(event) {
      var input = event.target;

      reader = new FileReader();
      reader.onload = function(){
          var text = reader.result;
          console.log("WELCOME.HTML readFile() MAINFILE "+text);  

          postToServer("MAINFILE",text);
      };
      reader.readAsText(input.files[0]);
    };
</SCRIPT>


   <div id='mainpage'>
      <form action="LOGIN" method="post" id="login">
         <h1>Sign Up</h1>
         <button type="submit">Login</button>
         <div class="field">
            <input type="text" id="client" class="scalesY">Client</input>
         </div>
         <div class="field">
            <input type="text" id="year" class="scalesY">Year</input>
         </div>        
        <div class="field">            
            <input type="text" id="sessionId">SessionId</input> 
         </div>
       </form>
   </div>
   

   <SCRIPT>



      const strServerDNS = 'http://'+self.location.hostname+':'+PORT+'/';

      const form = document.querySelector("#login");

      form.addEventListener('submit', function (event) {   
         var elements=form.elements; 
         event.preventDefault();
         login(event,elements);      
      } );

      var content="";


 
      function login(event,elements) {       
/*
         let check = localStorage.getItem("mysession");
         if(check && check.length>10) {
            const credentials = {
            'sessionId':  localStorage.getItem("mysession"),
            'time': timeSymbol()
           };
           console.log("login() WITH PREVIOUS SESSION");
           // postAndDisplay("LOGIN",credentials);
           // SERVER NOT RECOGNIZING CERT Strings

         } else console.dir("login() NO PREVIOUS SESSION");
*/      

         for(let name in [ 'client', 'year', 'sessionId']) 
            console.log("Form["+name+"] ="+form[name].value);


         console.log("WELCOME C  "+form[1].value);
         console.log("WELCOME Y  "+form[2].value);
         console.log("WELCOME S  "+form[3].value);


            // post body data 
         const credentials = {
            'client':form[1].value,
            'year':  form[2].value,
            'sessionId': form[3].value,
            'time': timeSymbol()
         };
       

         postAndDisplay("LOGIN",credentials,100);
         
      }
     
    </SCRIPT> 
</body>
</html>
